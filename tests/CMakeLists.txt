# 'Google_test' is the subproject name
project(Google_tests)

# 'lib' is the folder with Google Test sources
add_subdirectory(lib)
include_directories(${gtest_SOURCE_DIR}/include ${gtest_SOURCE_DIR})

# 'Google_Tests_run' is the target name
# 'test1.cpp tests2.cpp' are source files with tests
add_executable(Google_Tests_run SearchTest.cpp ../GIS/GIS_315524694.cpp ../GIS/GIS_315524694.h ../UserCommon/entities/Entity.cpp ../UserCommon/entities/Entity.h ../UserCommon/entities/POI.cpp ../UserCommon/entities/POI.h ../UserCommon/entities/geometry/Geometry.h ../UserCommon/entities/geometry/Circle.cpp ../UserCommon/entities/geometry/Circle.h ../UserCommon/entities/Junction.cpp ../UserCommon/entities/Junction.h ../UserCommon/entities/Way.cpp ../UserCommon/entities/Way.h ../UserCommon/entities/JsonHandlers/parsers/EntityJsonParser.cpp ../UserCommon/entities/JsonHandlers/parsers/EntityJsonParser.h ../UserCommon/entities/geometry/Geometry.cpp ../Common/GISNamedTypes.h ../UserCommon/entities/JsonHandlers/parsers/GeometryJsonParser.cpp ../UserCommon/entities/JsonHandlers/parsers/GeometryJsonParser.h ../UserCommon/entities/JsonHandlers/parsers/CoordinatesJsonParser.cpp ../UserCommon/entities/JsonHandlers/parsers/CoordinatesJsonParser.h ../UserCommon/entities/JsonHandlers/Serializers/EntityJsonSerializer.cpp ../UserCommon/entities/JsonHandlers/Serializers/EntityJsonSerializer.h ../UserCommon/entities/JsonHandlers/Serializers/JsonFileWriter.cpp ../UserCommon/entities/JsonHandlers/Serializers/JsonFileWriter.h ../UserCommon/entities/JsonHandlers/Serializers/JsonFileWriter.cpp ../UserCommon/entities/JsonHandlers/Serializers/JsonFileWriter.h ../UserCommon/entities/JsonHandlers/Serializers/JsonFileWriter.cpp ../UserCommon/entities/JsonHandlers/Serializers/JsonFileWriter.h ../UserCommon/entities/JsonHandlers/Serializers/GeometryJsonSerializer.cpp ../UserCommon/entities/JsonHandlers/Serializers/GeometryJsonSerializer.h ../UserCommon/entities/JsonHandlers/Serializers/CoordinatesJsonSerializer.cpp ../UserCommon/entities/JsonHandlers/Serializers/CoordinatesJsonSerializer.h ../GIS/search/Grid.h ../Common/NamedType.h ../Common/CoordinatesMath.h ../GIS/search/Grid.cpp ../GIS/search/TopologicalSearch.cpp ../GIS/search/TopologicalSearch.h ../UserCommon/IdGenerator.h ../UserCommon/entities/geometry/PointList.cpp ../UserCommon/entities/geometry/PointList.h ../UserCommon/entities/geometry/Point.cpp ../UserCommon/entities/geometry/Point.h SearchTest.cpp ../UserCommon/Logger.cpp ../UserCommon/Logger.h GeometryTest.cpp error_handling.cpp error_handling_more.cpp GISMock.cpp GISMock.h _tests.cpp internalTests.cpp ../Common/NavigationGIS.h ../Common/Restrictions.h RestrictionsTest.cpp WayTests.cpp ../Navigation/AStar.cpp ../Navigation/AStar.h ../Navigation/Route.cpp ../Navigation/Route.h AStarTests.cpp ../Navigation/Routes.h ../Navigation/Routes.cpp ../Navigation/Navigation_315524694.h ../Navigation/Navigation_315524694.cpp ../UserCommon/Utils.h NavigationValidator.h NavigationValidator.cpp AStarTests2.cpp RandTestUtils.cpp RandTestUtils.h Bound.cpp Bound.h RouteMock.cpp RouteMock.h WayMock.cpp WayMock.h LoadSaveMapTests.cpp ../UserCommon/Utils.cpp testsEx2.cpp ../bonus.avoid_tolls/avoid_tolls.cpp
        ../Common/AbstractGIS.h ../Common/AbstractNavigation.h ../Common/AbstractRoute.h ../Common/AbstractRoutes.h ../Common/AbstractWay.h ../Common/NavigationRegistration.h ../Common/GISRegistration.h  ../Simulator/GISRegistration.cpp ../Simulator/NavigationRegistration.cpp ../Simulator/Simulation.cpp ../Simulator/Simulation.h ../Simulator/GISContainer.cpp ../Simulator/GISContainer.h ../Simulator/NavigationContainer.cpp ../Simulator/NavigationContainer.h ../Simulator/RequestsFileParser.cpp ../Simulator/RequestsFileParser.h ../Simulator/NavigationRequest.cpp ../Simulator/NavigationRequest.h Simulator/RequestsParsingTest.cpp ../Simulator/NavigationTasksManager.cpp ../Simulator/NavigationTasksManager.h)
target_link_libraries(Google_Tests_run gtest gtest_main)

file(GLOB_RECURSE MAP_FILES *.json Simulator/*.txt)

foreach (CurrentFile IN LISTS MAP_FILES)
    add_custom_command(
            TARGET Google_Tests_run PRE_BUILD
            COMMAND ${CMAKE_COMMAND} -E copy_if_different ${CurrentFile} .
            COMMENT "Copying map file: ${CurrentFile}")
endforeach ()